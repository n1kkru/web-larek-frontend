# Проектная работа "Веб-ларек"

Используемый стек: HTML, SCSS, TS, Webpack


## Описание данных

```TypeScript
type PaymentType = 'online' | 'upon receipt'
```
- тип описывающий способ оплаты ("онлайн" или "при получении"). Используется в интерфейсе

```TypeScript
interface IClient {
  payment: PaymentType;
  email: string;
  phone: string;
  address: string;
}
```
Реализуемый с его помощью класс хранит данные о введенной информации покупателя (способ оплаты, почта, телефон, адрес).

Для заказа используется интерфейс
```TypeScript
interface IOrder extends IClient {
  items: string[]
  total: number;
}
``` 
который расширяет ```IClient```  полем со списком выбранных продуктов и итоговой суммой заказа.

Интерфейс 
```TypeScript
interface IOrderSuccess {
  id: string;
  total: number;
}
```
реализует ответ сервера после заказа.

Для модального окна файл **Modal.ts**:
```TypeScript 
interface IModal {
  content: HTMLElement;
}
```

Для формы файл **Form.ts**:
```TypeScript 
interface IForm {
  fields: HTMLFormElement[];  // список полей формы
  valid: boolean;             // валидность
}
```
Класс формы включает в себя разметку полей формы и булево состояние валидности.


## Базовые классы

### 1. Класс **EventEmitter**
Обеспечивает работу событий. Позволяет установить и снять слушателей событий, вызвать слушателей при возникновении события».
Имеет методы **on**, **off**, **emit** - для подписки, отписки на событие и вызове подписчика при событии.

### 2. Класс **Api**
Содержит методы для работы с api. **get** для получения, **post** для размещения данных.


## Модели данных

### 1. Класс **Client**
Класс хранит данные о введенной покупателем информации (способ оплаты, почта, телефон, адрес) и общую сумму покупки.

### 2. Класс **Item**
Данный класс имплементирует такой интерфейс:
```TypeScript
interface IItem {
    id: string;         // идентификатор товара
    title: string;      // имя товара
    category: string;   // категория
    description: string;// описание
    image: string;      // изображение
    price: number;      // цена
  }
```
В нем хранятся данные об идентификаторе, названии, категории товара, описание товара, изображение товара и цена.

### 3. Класс **Catalog**
Данный класс имплементирует такой интерфейс:
```TypeScript
interface ICatalog {
  items: IItem[];             // список товаров
  add(item: IItem): void;     // метод добавления товара
  getItem(id: string): IItem; // получить товар по id
}
```
Класс хранит список товаров предстваленных на главном экране. Методы позволяют добавить товар в список и получить выбранный продукт.

### 4. Класс **Basket**
Модель корзины реализована через интерфейс
```TypeScript
interface IBasketModel {
  // items: Map<string, number>; // товар в виде название: цена
  items: ICatalog;            // список товаров в корзине (?)
  totalPrice: number;         // итоговая цена
  add(id: string): void;      // добавить товар в корзину
  remove(id: string) : void;  // удалить из корзины
}
```
Класс содержит в себе поля для хранения списка товаров в корзине и итоговой цены, а также методы для добавления и удаления элементов корзины.

### 5. Класс **Order**
Данный класс реализует хранение данных покупателя для составления заказа.


## Компоненты
Основной компонентой является класс **Page**, имплементированный от интерфейса
```TypeScript
interface IPage {
  catalog: HTMLElement[]; // каталог товаров
  basket?: HTMLElement;  // корзина
}
```
Включает в себя логотип, каталог товаров и корзину. В каталоге содержится компонента карточки товаров с интерфейсом
```TypeScript
interface ICard {
  title: HTMLElement;
  image: HTMLImageElement;
  category: HTMLElement;
  price: HTMLElement;
  onClick: (event: MouseEvent) => void;
}
```
В ней есть поля для названия товара, изображения, категории, цены и метод для открытия модального окна выбранной карточки.
Оно наследуется от **IModal** и **ICard**
```TypeScript
interface IModalCard extends IModal, ICard{
  onClickBuy: (event: MouseEvent) => void;
  onClickClose: (event: MouseEvent) => void;
}
```
Метод **onClickClose** отвечает за закрытие модального окна карточки. А Метод **onClickBuy** отвечает за кнопку "В корзину".
При нажатии на нее данный товар добавляется в корзину. Открыть ее можно через главный экран при нажатии на элемент корзины.
Показывается компонент Basket с интерфейсом
```TypeScript
interface IBasketView {
  items: HTMLElement[]; // список товаров
  onClick: (event: MouseEvent) => void;
}
```
Здесь также есть список товаров и кнопка "Оформить" для открытия модальных окон с формами оформления заказа.
Для модалки с почтой и телефоном:
```TypeScript
interface IModalOrder extends IModal {
  form: IForm;
}
```
А для модального окна с адресом добавляется поле с типом оплаты
```TypeScript
interface IModalAddress extends IModalOrder {
  payment: HTMLButtonElement;
}
```
Переход между ними осуществляется через кнопку, при отсутствии ошибок валидации форм.

## Описание событий

Для работы с событиями используется **EventEmitter**.
- при загрузке страницы работает событие **"catalog:loading"**, который загружает список товаров,
- при клике на карточку товара срабатывает событие **"card:select"**, открывающее модальное окно с подробной информацией,
- при клике на иконку корзины вызывается событие **"basket:open"**, открывающее модальное окно с корзиной,
- нажимая на кнопку "В корзину" работает событие **"product:add"**, добавляющее выбранный товар в корзину,
- удалить продукт из корзины можно при нажатии на кнопку удаления, тогда сработает событие **"product:remove"**
- если в корзине кликнуть на кнопку "Оформить", то сработает событие **"order:start"** и откроется модальное окно оформления заказа,
- кнопки "Далее", "Оплатить" открывают следующее модальное окно при событии **"order:next"**,
- для иконки крестика и кнопки "За новыми покупками" в модальном окне успешного заказа работает событие **"modal:close"**





Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
