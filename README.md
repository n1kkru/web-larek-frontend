# Проектная работа "Веб-ларек"

Используемый стек: HTML, SCSS, TS, Webpack


## Описание данных

```TypeScript
type PaymentType = 'online' | 'upon receipt'
```
- тип описывающий способ оплаты ("онлайн" или "при получении"). Используется в интерфейсе **IClient**

Интерфейс для единицы товара.
```TypeScript
interface IItem {
    id: string;         // идентификатор товара
    title: string;      // имя товара
    category: string;   // категория
    description: string;// описание
    image: string;      // изображение
    price: number;      // цена
  }
```
В нем содержаться поля об идентификаторе, названии, категории товара, описание товара, изображение товара и цена.

Интерфейс 
```TypeScript
interface IOrderSuccess {
  id: string;
  total: number;
}
```
реализует ответ сервера после заказа.


## Базовые классы

### 1. Класс **EventEmitter**
Обеспечивает работу событий. Позволяет установить и снять слушателей событий, вызвать слушателей при возникновении события».
Имеет методы **on**, **off**, **emit** - для подписки, отписки на событие и вызове подписчика при событии.

### 2. Класс **Api**
Содержит методы для работы с api. **get** для получения, **post** для размещения данных.


## Модели данных

### 1. Класс **Catalog**
Данный класс имплементирует такой интерфейс:
```TypeScript
interface ICatalog {
  items: IOrder[];             // список товаров
  add(items: IOrder[]): void;  // метод добавления товаров
  getItem(id: string): IOrder; // получить товар по id
}
```
Класс хранит список товаров предстваленных на главном экране. Методы позволяют добавить список товаров и получить выбранный продукт.

### 2. Класс **Basket**
Модель корзины реализована через интерфейс
```TypeScript
interface IBasketModel {
  items: Map<string, number>; // список товаров в корзине (?)
  add(id: string): void;      // добавить товар в корзину
  remove(id: string) : void;  // удалить из корзины
  clear(): void;              // отчистить корзину
}
```
Класс содержит в себе поля для хранения списка товаров в корзине, а также методы для добавления и удаления элементов корзины.

### 3. Класс **WebAPI**
Содержит методы для взаимодействаия с сервером. GET запросы на получение списка товаров и одного товара по id. POST запросдля оформления заказа. 
Реализуется через интерфейс
```TypeScript
interface IWebAPI {
  getProductList: () => Promise<IItem[]>;
  getItem: (id: string) => Promise<IItem>;
  postOrder: (order: IOrder) => Promise<IOrderSuccess>;
}
```


## Компоненты представления

В файле **Modal.ts** описан интерфейс **базовой** компоненты:
```TypeScript 
interface IModal {
  content: HTMLElement;
  open(): void;
  сlose: (event: MouseEvent) => void;
  render(): HTMLElement;
}
```
Класс **Modal** содержит метод **close**, который отвечает за закрытие модального окна. Метод **open** для открытия и **render**, который отвечает за то, чтобы вернуть DOM-элемент.

**Базовую** компоненту для описания формы содержит файл **Form.ts**:
```TypeScript 
interface IForm {
  fields: HTMLFormElement[];  // список полей формы
  valid: boolean;             // валидность
  render(): HTMLElement
}
```
Класс формы включает в себя разметку полей формы, булево состояние валидности и метод для отрисовки разметки **render**.

Основной компонентой представления является класс **Page**, имплементированный от интерфейса
```TypeScript
interface IPage {
  catalog: HTMLElement[]; // каталог товаров
  basket: HTMLElement;    // корзина
}
```
Включает в себя логотип, каталог товаров и корзину. В каталоге содержится компонента карточки товаров с интерфейсом
```TypeScript
interface ICard {
  title: HTMLElement;
  image: HTMLImageElement;
  category: HTMLElement;
  price: HTMLElement;
  onClick: (event: MouseEvent) => void;
}
```
В ней есть поля для названия товара, изображения, категории, цены и метод для открытия модального окна выбранной карточки. В модалке содержится описание товара и кпопка. При нажатии на нее данный товар добавляется в корзину. Открыть ее можно через главный экран при нажатии на иконку корзины.
Показывается модалка с компонентой Basket с интерфейсом
```TypeScript
interface IBasketView {
  items: HTMLElement[];
  total: number;
}
```
Здесь есть список товаров, которые можно удалять при нажатии на соответсвующие кнопки, общая сумма заказа и кнопка "Оформить" для открытия модальных окон с формами оформления заказа. Интерфейс для формы с адресом и способом получения выглядит так:
```TypeScript
interface IOrderAddress {
  payment: PaymentType;
  address: string;
}
```
В модальном окне есть меню выбора способа оплаты, поля для адреса и кнопка "Далее", которая открывает другую форму в этом модальном окне.
```TypeScript
interface IOrderEmail {
  email: string;
  phone: string;
}
```
При нажатии на кнопку "Оплатить", в модалке появляется сообщение об успешной покупке.
Классы компоненты представления **OrderAddress**  и **OrderEmail** являются дочерними для **Form**.

Класс **Order** хранит данные покупателя для оформления заказа (отправки запроса на сервер)
```TypeScript
interface IOrder extends IOrderAddress, IOrderEmail {
  items: string[];
  total: number;
}
```


## Описание событий

Для работы с событиями используется **EventEmitter**.
- при загрузке страницы работает событие 
**"catalog:loading"**, который загружает список товаров,
- для открытия модального окна служит событие **"modal:open"**
- при клике на карточку товара срабатывает событие **"card:open"**, открывающее модальное окно с подробной информацией,
- при клике на иконку корзины вызывается событие **"basket:open"**, открывающее модальное окно с корзиной,
- нажимая на кнопку "В корзину" работает событие **"product:add"**, добавляющее выбранный товар в корзину,
- удалить продукт из корзины можно при нажатии на кнопку удаления, тогда сработает событие **"product:remove"**
- если в корзине кликнуть на кнопку "Оформить", то сработает событие **"order:start"** и откроется модальное окно оформления заказа,
- кнопки "Далее", "Оплатить" открывают следующее модальное окно при событии **"order:next"**,
- заказ оформлен **"order:submit"**
- для иконки крестика всех модалок и кнопки "За новыми покупками" в модальном окне успешного заказа работает событие **"modal:close"**


Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
